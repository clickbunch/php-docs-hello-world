(()=>{"use strict";window["br_foxstrike_0_3"]=e=>{var t;try{const n=window.googletag=window.googletag||{cmd:[]},i=window.foxstrike=window.foxstrike||{cmd:[]},o=window[e.templateParams.libraryName];if(!o)return e.callback(!0,`no_tmzLibrary_found_at_window[${e.templateParams.libraryName}]`);const l=o.select&&o.select(o.selectors.getAdSlots);if(!l)return e.callback(!0,"no_foxSlots_found");const r=window.DEVICE_VIEW;if(!r)return e.callback(!0,"no_foxStrikeDeviceView_found");let a,d=e.prebidGlobalInstanceName&&window[e.prebidGlobalInstanceName];const s=function(t){t.adUnitCode===e.divId&&(a=[t.width,t.height])};d.que=d.que||[],d.que.push((function(){d.onEvent("bidWon",s)}));const c=25,u=window._middyo&&(null===(t=window._middyo.i)||void 0===t?void 0:t.sc),f=v(e.targeting,!1);let m;if(u){let p=l.filter((function(e){var t;return(null===(t=null==e?void 0:e.strikeSize)||void 0===t?void 0:t.indexOf("ban"))>-1&&/ban(\d+)$/.test(null==e?void 0:e.strikeSize)})).map((e=>{const t=/ban(\d+)$/.exec(e.strikeSize);return(null==t?void 0:t.length)&&t.length>1&&Number(t[1])}));if(!p.length)return e.callback(!0,"no_leaderboard_found");let E=p[p.length-1]+1;m=`ban${E+e.demandIndex}`}else{const k="tablet"==r?"lb":"ban";let y,_=l.filter((function(e){return e.strikeSize&&e.strikeSize.indexOf(k)>-1})).length+1;_=e.spotIndex%100<4?_+e.spotIndex%4:_+3,y="tablet"==r&&_>6?6:_,m=k+y}const w="smartphone"===r?"mobile":r;function v(e,t){let n={};for(let t of e)n[t.key]=Array.isArray(t.value)?t.value:[t.value];return t&&(n.browsiRefresh="true"),n}function b(t){let i=o=>{if(t===o.slot.getSlotElementId()){n.pubads().removeEventListener("slotRenderEnded",i);const r={gamInfo:{lid:o.lineItemId,oid:o.campaignId},adUnit:o.slot.getAdUnitPath()};if(o.isEmpty)return e.callback(!0,void 0,r);{const d=document.getElementById(t);function s(t){return a=a||t.size,setTimeout((()=>{d&&d.parentElement&&(d.parentElement.style.minHeight=a[1]+"px")}),3e3),e.callback(t.isEmpty,void 0,r)}1===o.size[0]&&1===o.size[1]?d&&(l=d,new Promise((e=>{let t,n;n=setTimeout((()=>(clearInterval(t),e())),5e3),t=setInterval((()=>{if(g(l))return clearInterval(t),clearTimeout(n),e()}),200)}))).then((e=>{s(o)})):s(o)}}var l};n.pubads().addEventListener("slotRenderEnded",i)}function g(e){const t=h(e);return t.w>c&&t.h>c}function h(e){let t={w:0,h:0};return e.childNodes.forEach((e=>{if((n=e)&&n instanceof Element){let n=I(e);t.w=Math.max(t.w,n.w),t.h+=n.h}var n})),t}function I(e){const t=e.getBoundingClientRect();return{h:t.height,w:t.width}}i.cmd.push((function(t){var n;const i=t.getConfig(),o=null===(n=null==i?void 0:i.meta)||void 0===n?void 0:n.pageType;b(e.divId),t.insertAd(w,m,e.divId,o,f)}))}catch(x){e.callback(!0,x.message)}}})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9nZW5lcmljLXRlbXBsYXRlcy1qc29ucC8uL3NyYy9mb3hzdHJpa2UvZm94c3RyaWtlLnRzIl0sIm5hbWVzIjpbIndpbmRvdyIsImRhdGEiLCJfYSIsImdvb2dsZXRhZyIsImNtZCIsImZveHN0cmlrZSIsInRtekxpYnJhcnkiLCJ0ZW1wbGF0ZVBhcmFtcyIsImxpYnJhcnlOYW1lIiwiY2FsbGJhY2siLCJmb3hTbG90cyIsInNlbGVjdCIsInNlbGVjdG9ycyIsImdldEFkU2xvdHMiLCJmb3hTdHJpa2VEZXZpY2VWaWV3Iiwid2luU2l6ZSIsInByZWJpZEluc3RhbmNlIiwicHJlYmlkR2xvYmFsSW5zdGFuY2VOYW1lIiwiYmlkV29uSGFuZGxlciIsImV2ZW50RGF0YSIsImFkVW5pdENvZGUiLCJkaXZJZCIsIndpZHRoIiwiaGVpZ2h0IiwicXVlIiwicHVzaCIsIm9uRXZlbnQiLCJNSU5fQURfU0laRSIsImlzRGVza3RvcCIsImkiLCJzYyIsImZveFRhcmdldGluZyIsImJ1aWxkVGFyZ2V0aW5nIiwidGFyZ2V0aW5nIiwiZm94QWRVbml0IiwiYmFubmVycyIsImZpbHRlciIsImZzIiwic3RyaWtlU2l6ZSIsImluZGV4T2YiLCJ0ZXN0IiwibWFwIiwicmVnZXhSZXN1bHQiLCJleGVjIiwibGVuZ3RoIiwiTnVtYmVyIiwibmV4dEJhbm5lckluZGV4IiwiZGVtYW5kSW5kZXgiLCJmb3hTaXplIiwiZm94SW5kZXgiLCJpbmRleCIsInNwb3RJbmRleCIsImZveERldmljZSIsImJyb3dzaVRhcmdldGluZyIsInJlZnJlc2giLCJ0YXJnZXRpbmdPYmplY3QiLCJpdGVtIiwia2V5IiwiQXJyYXkiLCJpc0FycmF5IiwidmFsdWUiLCJhZGRFdmVudExpc3RlbmVyIiwidW5pdENvZGUiLCJsaXN0ZW5lckNhbGxiYWNrIiwiZXZlbnQiLCJzbG90IiwiZ2V0U2xvdEVsZW1lbnRJZCIsInB1YmFkcyIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJjYWxsYmFja1BhcmFtcyIsImdhbUluZm8iLCJsaWQiLCJsaW5lSXRlbUlkIiwib2lkIiwiY2FtcGFpZ25JZCIsImFkVW5pdCIsImdldEFkVW5pdFBhdGgiLCJpc0VtcHR5IiwidW5kZWZpbmVkIiwiY29udGFpbmVyIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsIm9uV2luIiwic2l6ZSIsInNldFRpbWVvdXQiLCJwYXJlbnRFbGVtZW50Iiwic3R5bGUiLCJtaW5IZWlnaHQiLCJlbGVtZW50IiwiUHJvbWlzZSIsInJlc29sdmUiLCJpbnRlcnZhbElkIiwidGltZU91dCIsImNsZWFySW50ZXJ2YWwiLCJzZXRJbnRlcnZhbCIsImlzVmFsaWRBZFNpemUiLCJjbGVhclRpbWVvdXQiLCJ0aGVuIiwicmVzdWx0IiwiYWRTaXplIiwiZ2V0QWRTaXplIiwidyIsImgiLCJjaGlsZHJlblNpemUiLCJjaGlsZE5vZGVzIiwiZm9yRWFjaCIsImNoaWxkTm9kZSIsIkVsZW1lbnQiLCJlbGVtZW50U2l6ZSIsImdldEVsZW1lbnRTaXplIiwiTWF0aCIsIm1heCIsImNsaWVudFJlY3QiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJTdHJpa2UiLCJzdHJpa2VDb25maWciLCJnZXRDb25maWciLCJwYWdlVHlwZSIsIm1ldGEiLCJpbnNlcnRBZCIsImUiLCJtZXNzYWdlIl0sIm1hcHBpbmdzIjoibUJBQ0FBLE9BQU8sc0JBQXlCQyxJQUM1QixJQUFJQyxFQUNKLElBQ0ksTUFBTUMsRUFBWUgsT0FBa0IsVUFBSUEsT0FBa0IsV0FBSyxDQUFFSSxJQUFLLElBQ2hFQyxFQUFZTCxPQUFrQixVQUFJQSxPQUFrQixXQUFLLENBQUVJLElBQUssSUFDaEVFLEVBQWFOLE9BQU9DLEVBQUtNLGVBQWVDLGFBQzlDLElBQUtGLEVBQ0QsT0FBT0wsRUFBS1EsVUFBUyxFQUFNLGlDQUFpQ1IsRUFBS00sZUFBZUMsZ0JBRXBGLE1BQU1FLEVBQVdKLEVBQVdLLFFBQVVMLEVBQVdLLE9BQU9MLEVBQVdNLFVBQVVDLFlBQzdFLElBQUtILEVBQ0QsT0FBT1Qs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QVNBLEVBQUdtSCxTQUM5SXhELEVBQWlCNUQsRUFBS29CLE9BQ3RCNkYsRUFBT0ssU0FBU25FLEVBQVdsQixFQUFXakMsRUFBS29CLE1BQU9nRyxFQUFVdEYsTUEyRnBFLE1BQU95RixHQUVIdkgsRUFBS1EsVUFBUyxFQUFNK0csRUFBRUMsWSIsImZpbGUiOiJmb3hzdHJpa2UvZm94c3RyaWtlLnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG53aW5kb3dbXCI8R0VORVJJQ19GVU5DVElPTj5cIl0gPSAoZGF0YSkgPT4ge1xuICAgIHZhciBfYTtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBnb29nbGV0YWcgPSB3aW5kb3dbXCJnb29nbGV0YWdcIl0gPSB3aW5kb3dbXCJnb29nbGV0YWdcIl0gfHwgeyBjbWQ6IFtdIH07XG4gICAgICAgIGNvbnN0IGZveHN0cmlrZSA9IHdpbmRvd1tcImZveHN0cmlrZVwiXSA9IHdpbmRvd1tcImZveHN0cmlrZVwiXSB8fCB7IGNtZDogW10gfTtcbiAgICAgICAgY29uc3QgdG16TGlicmFyeSA9IHdpbmRvd1tkYXRhLnRlbXBsYXRlUGFyYW1zLmxpYnJhcnlOYW1lXTtcbiAgICAgICAgaWYgKCF0bXpMaWJyYXJ5KSB7XG4gICAgICAgICAgICByZXR1cm4gZGF0YS5jYWxsYmFjayh0cnVlLCBgbm9fdG16TGlicmFyeV9mb3VuZF9hdF93aW5kb3dbJHtkYXRhLnRlbXBsYXRlUGFyYW1zLmxpYnJhcnlOYW1lfV1gKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBmb3hTbG90cyA9IHRtekxpYnJhcnkuc2VsZWN0ICYmIHRtekxpYnJhcnkuc2VsZWN0KHRtekxpYnJhcnkuc2VsZWN0b3JzLmdldEFkU2xvdHMpO1xuICAgICAgICBpZiAoIWZveFNsb3RzKSB7XG4gICAgICAgICAgICByZXR1cm4gZGF0YS5jYWxsYmFjayh0cnVlLCAnbm9fZm94U2xvdHNfZm91bmQnKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBmb3hTdHJpa2VEZXZpY2VWaWV3ID0gd2luZG93WydERVZJQ0VfVklFVyddO1xuICAgICAgICBpZiAoIWZveFN0cmlrZURldmljZVZpZXcpIHtcbiAgICAgICAgICAgIHJldHVybiBkYXRhLmNhbGxiYWNrKHRydWUsICdub19mb3hTdHJpa2VEZXZpY2VWaWV3X2ZvdW5kJyk7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHdpblNpemU7XG4gICAgICAgIGxldCBwcmViaWRJbnN0YW5jZSA9IGRhdGEucHJlYmlkR2xvYmFsSW5zdGFuY2VOYW1lICYmIHdpbmRvd1tkYXRhLnByZWJpZEdsb2JhbEluc3RhbmNlTmFtZV07XG4gICAgICAgIGNvbnN0IGJpZFdvbkhhbmRsZXIgPSBmdW5jdGlvbiAoZXZlbnREYXRhKSB7XG4gICAgICAgICAgICBpZiAoZXZlbnREYXRhLmFkVW5pdENvZGUgPT09IGRhdGEuZGl2SWQpIHtcbiAgICAgICAgICAgICAgICB3aW5TaXplID0gW1xuICAgICAgICAgICAgICAgICAgICBldmVudERhdGEud2lkdGgsXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50RGF0YS5oZWlnaHRcbiAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBwcmViaWRJbnN0YW5jZS5xdWUgPSBwcmViaWRJbnN0YW5jZS5xdWUgfHwgW107XG4gICAgICAgIHByZWJpZEluc3RhbmNlLnF1ZS5wdXNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHByZWJpZEluc3RhbmNlLm9uRXZlbnQoJ2JpZFdvbicsIGJpZFdvbkhhbmRsZXIpO1xuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgTUlOX0FEX1NJWkUgPSAyNTtcbiAgICAgICAgY29uc3QgaXNEZXNrdG9wID0gd2luZG93WydfbWlkZHlvJ10gJiYgKChfYSA9IHdpbmRvd1snX21pZGR5byddLmkpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5zYyk7XG4gICAgICAgIGNvbnN0IGZveFRhcmdldGluZyA9IGJ1aWxkVGFyZ2V0aW5nKGRhdGEudGFyZ2V0aW5nLCBmYWxzZSk7XG4gICAgICAgIGxldCBmb3hBZFVuaXQ7XG4gICAgICAgIGlmIChpc0Rlc2t0b3ApIHtcbiAgICAgICAgICAgIGxldCBiYW5uZXJzID0gZm94U2xvdHMuZmlsdGVyKGZ1bmN0aW9uIChmcykge1xuICAgICAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgICAgICByZXR1cm4gKChfYSA9IGZzID09PSBudWxsIHx8IGZzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBmcy5zdHJpa2VTaXplKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuaW5kZXhPZignYmFuJykpID4gLTEgJiYgL2JhbihcXGQrKSQvLnRlc3QoZnMgPT09IG51bGwgfHwgZnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGZzLnN0cmlrZVNpemUpO1xuICAgICAgICAgICAgfSkubWFwKGZzID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCByZWdleFJlc3VsdCA9IC9iYW4oXFxkKykkLy5leGVjKGZzLnN0cmlrZVNpemUpO1xuICAgICAgICAgICAgICAgIHJldHVybiAocmVnZXhSZXN1bHQgPT09IG51bGwgfHwgcmVnZXhSZXN1bHQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHJlZ2V4UmVzdWx0Lmxlbmd0aCkgJiYgcmVnZXhSZXN1bHQubGVuZ3RoID4gMSAmJiBOdW1iZXIocmVnZXhSZXN1bHRbMV0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoIWJhbm5lcnMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEuY2FsbGJhY2sodHJ1ZSwgJ25vX2xlYWRlcmJvYXJkX2ZvdW5kJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsZXQgbmV4dEJhbm5lckluZGV4ID0gYmFubmVyc1tiYW5uZXJzLmxlbmd0aCAtIDFdICsgMTtcbiAgICAgICAgICAgIGZveEFkVW5pdCA9IGBiYW4ke25leHRCYW5uZXJJbmRleCArIGRhdGEuZGVtYW5kSW5kZXh9YDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGZveFNpemUgPSBmb3hTdHJpa2VEZXZpY2VWaWV3ID09IFwidGFibGV0XCIgPyBcImxiXCIgOiAnYmFuJztcbiAgICAgICAgICAgIGxldCBmb3hJbmRleDtcbiAgICAgICAgICAgIGxldCBpbmRleCA9IGZveFNsb3RzLmZpbHRlcihmdW5jdGlvbiAoZnMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZnMuc3RyaWtlU2l6ZSAmJiBmcy5zdHJpa2VTaXplLmluZGV4T2YoZm94U2l6ZSkgPiAtMTtcbiAgICAgICAgICAgIH0pLmxlbmd0aCArIDE7XG4gICAgICAgICAgICBpbmRleCA9IChkYXRhLnNwb3RJbmRleCAlIDEwMCA8IDQpID8gaW5kZXggKyBkYXRhLnNwb3RJbmRleCAlIDQgOiBpbmRleCArIDM7XG4gICAgICAgICAgICBpZiAoZm94U3RyaWtlRGV2aWNlVmlldyA9PSBcInRhYmxldFwiKSB7IC8vdGhleSBkb250IHNlbmQgbGIgaGlnaGVyIHRoYW4gNlxuICAgICAgICAgICAgICAgIGlmIChpbmRleCA+IDYpIHtcbiAgICAgICAgICAgICAgICAgICAgZm94SW5kZXggPSA2O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZm94SW5kZXggPSBpbmRleDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBmb3hJbmRleCA9IGluZGV4O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm94QWRVbml0ID0gZm94U2l6ZSArIGZveEluZGV4O1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGZveERldmljZSA9IGZveFN0cmlrZURldmljZVZpZXcgPT09IFwic21hcnRwaG9uZVwiID8gXCJtb2JpbGVcIiA6IGZveFN0cmlrZURldmljZVZpZXc7XG4gICAgICAgIGZveHN0cmlrZS5jbWQucHVzaChmdW5jdGlvbiAoU3RyaWtlKSB7XG4gICAgICAgICAgICB2YXIgX2E7XG4gICAgICAgICAgICBjb25zdCBzdHJpa2VDb25maWcgPSBTdHJpa2UuZ2V0Q29uZmlnKCk7XG4gICAgICAgICAgICBjb25zdCBwYWdlVHlwZSA9IChfYSA9IHN0cmlrZUNvbmZpZyA9PT0gbnVsbCB8fCBzdHJpa2VDb25maWcgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHN0cmlrZUNvbmZpZy5tZXRhKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EucGFnZVR5cGU7XG4gICAgICAgICAgICBhZGRFdmVudExpc3RlbmVyKGRhdGEuZGl2SWQpO1xuICAgICAgICAgICAgU3RyaWtlLmluc2VydEFkKGZveERldmljZSwgZm94QWRVbml0LCBkYXRhLmRpdklkLCBwYWdlVHlwZSwgZm94VGFyZ2V0aW5nKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGZ1bmN0aW9uIGJ1aWxkVGFyZ2V0aW5nKGJyb3dzaVRhcmdldGluZywgcmVmcmVzaCkge1xuICAgICAgICAgICAgbGV0IHRhcmdldGluZ09iamVjdCA9IHt9O1xuICAgICAgICAgICAgZm9yIChsZXQgaXRlbSBvZiBicm93c2lUYXJnZXRpbmcpIHtcbiAgICAgICAgICAgICAgICB0YXJnZXRpbmdPYmplY3RbaXRlbS5rZXldID0gQXJyYXkuaXNBcnJheShpdGVtLnZhbHVlKSA/IGl0ZW0udmFsdWUgOiBbaXRlbS52YWx1ZV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocmVmcmVzaCkge1xuICAgICAgICAgICAgICAgIHRhcmdldGluZ09iamVjdFtcImJyb3dzaVJlZnJlc2hcIl0gPSBcInRydWVcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0YXJnZXRpbmdPYmplY3Q7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gYWRkRXZlbnRMaXN0ZW5lcih1bml0Q29kZSkge1xuICAgICAgICAgICAgbGV0IGxpc3RlbmVyQ2FsbGJhY2sgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodW5pdENvZGUgPT09IGV2ZW50LnNsb3QuZ2V0U2xvdEVsZW1lbnRJZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGdvb2dsZXRhZy5wdWJhZHMoKS5yZW1vdmVFdmVudExpc3RlbmVyKCdzbG90UmVuZGVyRW5kZWQnLCBsaXN0ZW5lckNhbGxiYWNrKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2FsbGJhY2tQYXJhbXMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBnYW1JbmZvOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlkOiBldmVudC5saW5lSXRlbUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9pZDogZXZlbnQuY2FtcGFpZ25JZFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkVW5pdDogZXZlbnQuc2xvdC5nZXRBZFVuaXRQYXRoKClcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LmlzRW1wdHkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhLmNhbGxiYWNrKHRydWUsIHVuZGVmaW5lZCwgY2FsbGJhY2tQYXJhbXMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodW5pdENvZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gb25XaW4oZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5TaXplID0gd2luU2l6ZSB8fCBldmVudC5zaXplO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29udGFpbmVyICYmIGNvbnRhaW5lci5wYXJlbnRFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXIucGFyZW50RWxlbWVudC5zdHlsZS5taW5IZWlnaHQgPSB3aW5TaXplWzFdICsgJ3B4JztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDMwMDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhLmNhbGxiYWNrKGV2ZW50LmlzRW1wdHksIHVuZGVmaW5lZCwgY2FsbGJhY2tQYXJhbXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LnNpemVbMF0gPT09IDEgJiYgZXZlbnQuc2l6ZVsxXSA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb250YWluZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2FpdEZvclZhbGlkRWxlbWVudFNpemUoY29udGFpbmVyKS50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uV2luKGV2ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25XaW4oZXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGdvb2dsZXRhZy5wdWJhZHMoKS5hZGRFdmVudExpc3RlbmVyKFwic2xvdFJlbmRlckVuZGVkXCIsIGxpc3RlbmVyQ2FsbGJhY2spO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHdhaXRGb3JWYWxpZEVsZW1lbnRTaXplKGVsZW1lbnQpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBpbnRlcnZhbElkLCB0aW1lT3V0O1xuICAgICAgICAgICAgICAgIHRpbWVPdXQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbElkKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICB9LCA1MDAwKTtcbiAgICAgICAgICAgICAgICBpbnRlcnZhbElkID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXNWYWxpZEFkU2l6ZShlbGVtZW50KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbElkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lT3V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LCAyMDApO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gaXNWYWxpZEFkU2l6ZShlbGVtZW50KSB7XG4gICAgICAgICAgICBjb25zdCBhZFNpemUgPSBnZXRBZFNpemUoZWxlbWVudCk7XG4gICAgICAgICAgICByZXR1cm4gKGFkU2l6ZS53ID4gTUlOX0FEX1NJWkUgJiYgYWRTaXplLmggPiBNSU5fQURfU0laRSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZ2V0QWRTaXplKGNvbnRhaW5lcikge1xuICAgICAgICAgICAgbGV0IGNoaWxkcmVuU2l6ZSA9IHsgdzogMCwgaDogMCB9O1xuICAgICAgICAgICAgY29udGFpbmVyLmNoaWxkTm9kZXMuZm9yRWFjaChjaGlsZE5vZGUgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChpc0VsZW1lbnQoY2hpbGROb2RlKSkge1xuICAgICAgICAgICAgICAgICAgICBsZXQgZWxlbWVudFNpemUgPSBnZXRFbGVtZW50U2l6ZShjaGlsZE5vZGUpO1xuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlblNpemUudyA9IE1hdGgubWF4KGNoaWxkcmVuU2l6ZS53LCBlbGVtZW50U2l6ZS53KTtcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW5TaXplLmggKz0gZWxlbWVudFNpemUuaDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBjaGlsZHJlblNpemU7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZ2V0RWxlbWVudFNpemUoZWxlbWVudCkge1xuICAgICAgICAgICAgY29uc3QgY2xpZW50UmVjdCA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgICAgICByZXR1cm4geyBoOiBjbGllbnRSZWN0LmhlaWdodCwgdzogY2xpZW50UmVjdC53aWR0aCB9O1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGlzRWxlbWVudChlbGVtZW50KSB7XG4gICAgICAgICAgICByZXR1cm4gKGVsZW1lbnQgJiYgZWxlbWVudCBpbnN0YW5jZW9mIEVsZW1lbnQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICBkYXRhLmNhbGxiYWNrKHRydWUsIGUubWVzc2FnZSk7XG4gICAgfVxufTtcbiJdLCJzb3VyY2VSb290IjoiIn0=